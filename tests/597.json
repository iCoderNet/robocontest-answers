{"code":"#include<bits\/stdc++.h>\r\nusing namespace std;\r\n\r\n#define f(i,n) for(int i = 0; i < n; i++)\r\n#define M 1000\r\n#define D 1000000007\r\nint dp[M][M];\r\n\r\nint main()  {\r\n\r\n    ios_base::sync_with_stdio(0);\r\n    cin.tie(NULL);\r\n    cout.tie(NULL);\r\n\r\n    int n, m;\r\n    cin >> n >> m;\r\n    char xx;\r\n    f(i,n)f(j,m) {\r\n            cin >> xx;\r\n            dp[i][j] = xx == '0' ? 0 : -1;\r\n        }\r\n    if (dp[0][0] == -1 || dp[n-1][m-1] == -1)\r\n        return cout << 0, 0;\r\n    dp[0][0] = 1;\r\n\r\n    f(i,n) f(j,m)\r\n            if (dp[i][j] != -1) {\r\n                if (i + 1 < n && dp[i+1][j] != -1)\r\n                    dp[i+1][j] = (dp[i+1][j] + dp[i][j]) % D;\r\n                else {\r\n                    int k = dp[i][j];\r\n                    int x = i;\r\n                    while (x + 1 < n && dp[x+1][j] == -1) x++;\r\n                    if (x + 1 < n && dp[x+1][j] != -1)\r\n                        dp[x+1][j] = (dp[x+1][j] + k) % D;\r\n                }\r\n                if (j + 1 < m && dp[i][j+1] != -1)\r\n                    dp[i][j+1] = (dp[i][j+1] + dp[i][j]) % D;\r\n                else {\r\n                    int k = dp[i][j];\r\n                    while (j < m && dp[i][j+1] == -1)\r\n                        j++;\r\n                    if (j + 1 < m && dp[i][j+1] != -1)\r\n                        dp[i][j+1] = (dp[i][j+1] + k) % D;\r\n                }\r\n            }\r\n    cout << dp[n-1][m-1];\r\n\r\n    return 0;\r\n}","lang":4}