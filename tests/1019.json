{"code":"#include <bits\/stdc++.h>\r\n#define int long long\r\n#define e 1000000007\r\nusing namespace std;\r\nbool prime[200002];\r\nvector < int > pm;\r\nvoid saveprime() {\r\n\tprime[0] = prime[1] = 1;\r\n\tfor (int i = 2; i * i <= 200000; i++) {\r\n\t\tif (prime[i] == 0) {\r\n\t\t\tfor (int j = i * i; j <= 200000; j += i) {\r\n\t\t\t\tprime[j] = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nvoid dfs(int a[], int n, int k, int t) {\r\n    while (prime[n] && n >= pm[k] * pm[k]) {\r\n    \twhile (n % pm[k] == 0) {\r\n    \t\ta[pm[k]] += t;\r\n    \t\tn \/= pm[k];\r\n    \t}\r\n    \tk++;\r\n    }\r\n    if (n > 1) a[n] += t;\r\n}\r\nint g(int k, int n) {\r\n\tif (n == 0) return 1;\r\n\tint p = 1;\r\n\twhile (n > 1) {\r\n    \tif (n & 1) p = (p * k) % e;\r\n    \tk = (k * k) % e;\r\n    \tn \/= 2;\r\n\t}\r\n\treturn (p * k) % e;\r\n}\r\n\r\nsigned main() { \r\n\tios_base::sync_with_stdio(false); cin.tie(NULL); cout.tie(NULL);\r\n\tsaveprime();\r\n    int n, x;\r\n    cin >> n;\r\n    \r\n    for (int i = 2; i <= n; i++) {\r\n    \tif (prime[i] == 0) {\r\n    \t\tpm.push_back(i);\r\n    \t}\r\n    }\r\n    int a[10] = {0};\r\n    int b[n+1] = {0};\r\n    int c[n+1] = {0};\r\n        \r\n    for (int i = 1; i <= n; i++) {\r\n      cin >> x;\r\n      a[x]++;\r\n      dfs(b, i, 0, 1);\r\n    }\r\n    \r\n    for (int i = 0; i < 10; i++) {\r\n      for (int j = 1; j <= a[i]; j++) {\r\n        dfs(b, j, 0, -1);\r\n      }\r\n    }\r\n    for (int i = 0; i <= n; i++) \r\n    \tc[i] = b[i];\r\n    \r\n    dfs(c, n, 0, -1);   \r\n    dfs(c, a[0], 0, 1);\r\n    \r\n    int s1 = 1, s2 = 1;\r\n    for (int i = 2; i <= n; i++) {\r\n      s1 = (s1 * g(i, b[i])) % e;\r\n    }\r\n    for (int i = 2; i <= n; i++) {\r\n      s2 = (s2 * g(i, c[i])) % e;\r\n    }\r\n    \r\n    cout << (a[0] > 0 ? (s1+e-s2)%e : s1);\r\n\r\n    return 0;\r\n}","lang":4}