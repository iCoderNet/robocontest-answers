{"code":"#include <bits\/stdc++.h>\r\nusing namespace std;\r\n\r\n#define mx 26\r\nint arr[mx];\r\n\r\nchar f(list < char > & l3) {\r\n    string x, y;\r\n    x = y = \"\";\r\n    while (!l3.empty()) {\r\n        x = x + l3.front();\r\n        l3.pop_front();\r\n    }\r\n    int n = x.size();\r\n    int i = 1;\r\n    while (x.size() != 1 && i < x.size()) {\r\n        if (x[i] == '&') {\r\n            char left = x[i-1];\r\n            char rght = x[i+1];\r\n            x.erase(i-1, 1);\r\n            x.erase(i, 1);\r\n            if (left == '0' || rght == '0') {\r\n                x[i-1] = '0';\r\n            }\r\n            else {\r\n                x[i-1] = '1';\r\n            }\r\n        }\r\n        else {\r\n            i += 2;\r\n        }\r\n    }\r\n    while (x.size() > 1) {\r\n        char left = x[0];\r\n        char rght = x[2];\r\n        x.erase(0, 1);\r\n        x.erase(1, 1);\r\n        if (left == '0' && rght == '0') {\r\n            x[0] = '0';\r\n        }\r\n        else {\r\n            x[0] = '1';\r\n        }\r\n    }\r\n    return x[0];\r\n}\r\n\r\nchar solve()\r\n{\r\n    int n;\r\n    cin >> n;\r\n    for (int i = 0; i < n; i++) {\r\n        cin >> arr[i];\r\n    }\r\n    string s;\r\n    cin >> s;\r\n    s = '(' + s + ')';\r\n\r\n    int m = s.size();\r\n    list < char > l1, l2;\r\n    for (int i = 0; i < m; i++) {\r\n        if ('A' <= s[i] && s[i] <= 'Z')\r\n            l1.push_back(char(arr[s[i]-65] + 48));\r\n        else\r\n            l1.push_back(s[i]);\r\n    }\r\n\r\n\r\n    while (!l1.empty()) {\r\n        char x = l1.front();\r\n        if (x != ')') {\r\n            l2.push_back(x);\r\n        }\r\n        else {\r\n            list < char > l3;\r\n            char y = l2.back();\r\n            l2.pop_back();\r\n            l3.push_front(y);\r\n            while (l2.back() != '(') {\r\n                x = l2.back();\r\n                if (x == '!') {\r\n                    y = l3.front();\r\n                    l3.pop_front();\r\n                    l3.push_front(char(97 - y));\r\n                }\r\n                else {\r\n                    l3.push_front(x);\r\n                }\r\n                l2.pop_back();\r\n            }\r\n            l2.pop_back();\r\n            l2.push_back(f(l3));\r\n        }\r\n        l1.pop_front();\r\n    }\r\n    return l2.front();\r\n}\r\n\r\nint main()\r\n{\r\n    ios_base::sync_with_stdio(false);\r\n    cin.tie(NULL);\r\n    cout.tie(NULL);\r\n    \r\n    int t;\r\n    cin >> t;\r\n    while (t--) cout << solve() << endl;\r\n    return 0;\r\n}","lang":4}