{"code":"#include<bits\/stdc++.h>\r\n\r\nusing namespace std;\r\n\r\n#define pb push_back\r\n#define mk make_pair\r\n#define fr first\r\n#define sc second\r\n\r\n#define MOD 1000000007ll\r\n#define ull long long\r\n\r\nint T[100100][26];\r\nlong long F[100100];\r\n\r\null euclid(ull a, ull b, ull& rx, ull& ry) {\r\n    if (!b) return rx=1, ry=0, a;\r\n\r\n    ull q = a\/b;\r\n    ull x, y;\r\n    ull g = euclid(b, a-q*b, x, y);\r\n    return rx=y, ry=x-q*y, g;\r\n}\r\n\r\null invert(ull a, ull p) {\r\n    ull inverse, temp;\r\n    euclid(a, p, inverse, temp);\r\n    return (inverse%p+p)%p;\r\n}\r\n\r\nint main() {\r\n    ios_base::sync_with_stdio(false);\r\n    cin.tie(0);cout.tie(0);\r\n    F[0] = 1;\r\n    for(long long i=1; i<=100010; i++)\r\n        F[i] = (F[i-1] * i) % MOD;\r\n    string s;\r\n    cin >> s;\r\n    for(int i=0; i<s.size(); i++) {\r\n        T[i+1][s[i]-'a'] = 1;\r\n        for(int j=0; j<26; j++) {\r\n            T[i+1][j] += T[i][j];\r\n        }\r\n    }\r\n    int Q; cin >> Q;\r\n    for(int i=0; i<Q; i++) {\r\n        int L, R; cin >> L >> R;\r\n        long long div2 = 0, mod2 = 0, rem = 1;\r\n        for(int j=0; j<26; j++) {\r\n            int v = T[R][j] - T[L-1][j];\r\n            div2 += v\/2;\r\n            mod2 += (v%2 ? 1 : 0);\r\n            rem *= F[v\/2];\r\n            rem %= MOD;\r\n        }\r\n        long long answer = F[div2];\r\n        answer *= max(mod2, 1ll);\r\n        answer %= MOD;\r\n        answer *= invert(rem, MOD);\r\n        answer %= MOD;\r\n        cout << answer << endl;\r\n    }\r\n}","lang":4}