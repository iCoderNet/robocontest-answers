{"code":"#include<bits\/stdc++.h>\r\nusing namespace std;\r\n\r\n#define mx 100001\r\nint z[mx];\r\n\r\nstruct point\r\n{\r\n    int x, y;\r\n};\r\n\r\nvoid solve()\r\n{\r\n    string s;\r\n    cin >> s;\r\n\r\n    int n = s.size();\r\n    int L, R;\r\n\r\n    L = R = 0;\r\n    list < int > mp;\r\n\r\n    for (int i = 1; i < n; i++) {\r\n        if (R >= i)\r\n            z[i] = min(R-i+1, z[i-L]);\r\n        while (z[i]+i<n && s[z[i]] == s[z[i]+i])\r\n            z[i]++;\r\n        if (z[i]+i-1 > R)\r\n            L = i, R = z[i]+i-1;\r\n        if (z[i] > 0)\r\n            mp.push_back(z[i]);\r\n    }\r\n    \/*\r\n    for (int i = 0; i < n; i++) {\r\n        cout << z[i] << \" \";\r\n    }\r\n    cout << endl;\r\n    for (auto it=mp.begin(); it!=mp.end(); it++) {\r\n        cout << *it << \" \";\r\n    }\r\n    cout << endl;*\/\r\n\r\n    point arr[mx];\r\n    int index = 0;\r\n    mp.sort();\r\n    int ll = 1;\r\n    for (int i = n-1; i >= 1; i--) {\r\n        if (z[i] == ll)\r\n        {\r\n            arr[index++] = {ll, mp.size() + 1};\r\n        }\r\n        while (!mp.empty() && mp.front() == ll) {\r\n                mp.pop_front();\r\n        }\r\n        ll++;\r\n    }\r\n    arr[index++] = {n, 1};\r\n    cout << index << endl;\r\n    for (int i = 0; i < index; i++) {\r\n        cout << arr[i].x << \" \" << arr[i].y << endl;\r\n    }\r\n}\r\n\/\/abaabbabababbaababbab\r\nint main(){\r\n\r\n    ios_base::sync_with_stdio(0);\r\n    cin.tie(0);\r\n    cout.tie(0);\r\n\r\n    int t = 1;\r\n    while (t--) solve();\r\n    return 0;\r\n}","lang":4}