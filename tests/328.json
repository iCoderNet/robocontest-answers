{"code":"def ThreeEqualParts(A): \r\n\r\n    IMP = [-1, -1] \r\n    Sum = sum(A) \r\n\r\n    if Sum % 3: return IMP \r\n\r\n    K = Sum \/ 3\r\n\r\n    if K == 0: return [0, len(A) - 1] \r\n    \r\n    interval = [] \r\n    S = 0\r\n    \r\n    for i, x in enumerate(A): \r\n    \r\n        if x:\r\n            \r\n            S += x \r\n            if S in {1, K + 1, 2 * K + 1}: \r\n                interval.append(i) \r\n                \r\n            if S in {K, 2 * K, 3 * K}: \r\n                interval.append(i) \r\n\r\n    i1, j1, i2, j2, i3, j3 = interval \r\n\r\n\r\n    if not(A[i1:j1 + 1] == A[i2:j2 + 1] == A[i3:j3 + 1]): \r\n        return [-1, -1] \r\n\r\n    x = i2 - j1 - 1\r\n    y = i3 - j2 - 1\r\n    z = len(A) - j3 - 1\r\n\r\n    if x < z or y < z: return IMP\r\n\r\n    j1 += z \r\n    j2 += z \r\n\r\n    return [j1, j2 + 1] \r\n\r\nfor x in range(int(input())):\r\n\t\r\n\tn = int(input())\r\n\tA = list(map(int,input().split()))\r\n\tB = ThreeEqualParts(A)\r\n\t\r\n\tif sum(B) == -2:\r\n\t\tprint(-1)\r\n\telse:\r\n\t\tk = 0\r\n\t\tsm = 0\r\n\t\tmod = 10 ** 9 + 7\r\n\t\t\r\n\t\tfor i in A[0:B[0]+1][::-1]:\r\n\t\t\tif i == 1:\r\n\t\t\t\tsm = (sm + pow(2, k, mod)) % mod\r\n\t\t\tk += 1\r\n\t\t\r\n\t\tprint(sm)","lang":2}