{"code":"#include<bits\/stdc++.h>\r\n\r\nusing namespace std;\r\n\r\nint a[100001];\r\n\r\nint main()\r\n\r\n{\r\n\r\n    long long n, m, q, k, w = 1, l = 1, h;\r\n\r\n    cin >> q;\r\n\r\n    for (int j = 1; j <= q; j ++)\r\n\r\n    {\r\n\r\n        cin >> n;\r\n\r\n        for (int i = 1; i <= n; i ++)\r\n\r\n        {\r\n\r\n            cin >> a[i];\r\n\r\n        }\r\n\r\n        if (n == 2)\r\n\r\n        {\r\n\r\n            cout << abs(a[1] - a[2]) << endl;\r\n\r\n            continue;\r\n\r\n        }m = a[1];\r\n\r\n        k = a[1];\r\n\r\n        for (int i = 1; i <= n; i ++)\r\n\r\n        {\r\n\r\n            if (a[i] >= k)\r\n\r\n            {\r\n\r\n                l = i;\r\n\r\n                k = a[i];\r\n\r\n            }\r\n\r\n            if (a[i] <= m)\r\n\r\n            {\r\n\r\n                w = i;\r\nm = a[i];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        sort(a + 1 , a + n + 1);\r\n\r\n        h = a[n] - a[1];\r\n\r\n        if (l == 1 && w == n)\r\n\r\n        {\r\n\r\n            h = max(a[n - 1] - a[1] , a[n] - a[2]);\r\n\r\n        }\r\n\r\n        cout << h << endl;\r\n\r\n    }\r\n  }","lang":4}