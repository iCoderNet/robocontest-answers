{"code":"#include <bits\/stdc++.h>\r\n\r\nusing namespace std;\r\n\r\nconst int maxn = 5e2+10;\r\n\r\nint n, m, d[maxn][maxn];\r\npair<int, int> p[maxn][maxn];\r\nvector<int> g[maxn];\r\nbool marked[maxn][maxn];\r\n\r\nint main(){\r\n\tcin >> n >> m;\r\n\tfor (int i = 0; i < m; i++){\r\n\t\tint v, u;\r\n\t\tscanf(\"%d%d\", &v, &u);\r\n\t\tg[v].push_back(u);\r\n\t\tg[u].push_back(v);\r\n\t}\r\n\r\n\td[n][1] = -1;\r\n\tqueue<pair<int, int>> q;\r\n\tmarked[1][n] = true;\r\n\tq.push(make_pair(1, n));\r\n\twhile (!q.empty()){\r\n\t\tauto v = q.front();\r\n\t\tq.pop();\r\n\t\tfor (int u1: g[v.first]){\r\n\t\t\tfor (int u2: g[v.second]) if (u1 != u2){\r\n\t\t\t\tif (!marked[u1][u2]){\r\n\t\t\t\t\tq.push(make_pair(u1, u2));\r\n\t\t\t\t\tmarked[u1][u2] = true;\r\n\t\t\t\t\td[u1][u2] = d[v.first][v.second] + 1;\r\n\t\t\t\t\tp[u1][u2] = v;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (d[n][1] == -1){\r\n\t\tcout << \"Infinite!\" << endl;\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tcout << d[n][1]+1 << endl;\r\n\tvector<pair<int, int>> v;\r\n\tpair<int, int> x = make_pair(n, 1);\r\n\tv.push_back(x);\r\n\twhile (x != make_pair(1, n)){\r\n\t\tx = p[x.first][x.second];\r\n\t\tv.push_back(x);\r\n\t}\r\n    cout << \"P: \";\r\n\tfor (int i = v.size()-1; i >= 0; i--)\r\n\t\tcout << v[i].first << ' ';\r\n\tcout << endl;\r\n\tcout << \"M: \";\r\n\tfor (int i = v.size()-1; i>= 0; i--)\r\n\t\tcout << v[i].second << ' ';\r\n\treturn 0;\r\n}","lang":4}